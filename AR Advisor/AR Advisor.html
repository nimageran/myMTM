# Let's generate a single-file HTML tool as requested by the user.
# We'll save it to /mnt/data/ar_advisor.html

html = r"""<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>AR Advisor — Smart Helper</title>
<style>
  :root{
    --bg:#0f172a;          /* slate-900 */
    --panel:#111827ee;     /* gray-900 */
    --muted:#94a3b8;       /* slate-400 */
    --text:#e5e7eb;        /* gray-200 */
    --accent:#38bdf8;      /* sky-400 */
    --accent2:#a78bfa;     /* violet-400 */
    --ok:#22c55e;
    --warn:#f59e0b;
    --bad:#ef4444;
    --card:#0b1223;        /* darker card */
    --chip:#1f2937;        /* slate-800 */
    --chip-text:#cbd5e1;
    --shadow: 0 10px 30px rgba(0,0,0,.35);
    --radius: 18px;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    color:var(--text); background: radial-gradient(1200px 600px at 10% -10%, #1e293b, transparent), 
                        radial-gradient(900px 600px at 110% 10%, #0b1324, transparent),
                        linear-gradient(180deg, #0a0f1f, #020617);
  }
  .wrap{max-width:1200px; margin:24px auto; padding:0 16px;}
  header{
    display:flex; align-items:center; gap:16px; padding:16px; border-radius:var(--radius);
    background:linear-gradient(180deg, rgba(56,189,248,.15), rgba(167,139,250,.12));
    backdrop-filter: blur(6px); border:1px solid rgba(148,163,184,.25);
    box-shadow: var(--shadow);
  }
  header h1{margin:0; font-size:24px; letter-spacing:.3px;}
  header .sub{color:var(--muted); font-size:13px; margin-top:4px}
  .grid{display:grid; grid-template-columns: 1.1fr 1fr; gap:18px; margin-top:18px;}
  .card{
    background: linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,.01));
    border:1px solid rgba(148,163,184,.15);
    border-radius: var(--radius);
    box-shadow: var(--shadow);
  }
  .card .hd{padding:14px 16px; border-bottom:1px solid rgba(148,163,184,.12);
            display:flex; align-items:center; justify-content:space-between}
  .card .hd h3{margin:0; font-size:16px; letter-spacing:.25px}
  .card .bd{padding:16px; }
  .row{display:flex; gap:12px; align-items:center; flex-wrap:wrap; margin:12px 0}
  label{font-size:13px; color:var(--muted);}
  select,input[type=text],input[type=number],textarea{
    width:100%; padding:10px 12px; border-radius:12px; border:1px solid rgba(148,163,184,.2);
    background:#0b1223; color:var(--text); outline:none;
  }
  textarea{min-height:86px; resize:vertical}
  .radio-group,.check-group{display:flex; gap:10px; flex-wrap:wrap}
  .chip{padding:8px 10px; border-radius:999px; background:var(--chip); color:var(--chip-text);
        font-size:12px; border:1px solid rgba(148,163,184,.15);}
  .hint{font-size:12px; color:var(--muted);}
  .btn{cursor:pointer; padding:10px 14px; border-radius:12px; border:none; font-weight:600;
       background: linear-gradient(90deg, var(--accent), var(--accent2)); color:#04121d;
       box-shadow: var(--shadow)}
  .btn.ghost{background:transparent; color:var(--text); border:1px solid rgba(148,163,184,.25)}
  .btn.small{padding:6px 10px; font-size:12px}
  .pill{display:inline-flex; align-items:center; gap:8px; padding:6px 10px; border-radius:999px; font-size:12px}
  .ok{background:rgba(34,197,94,.12); border:1px solid rgba(34,197,94,.35); color:#bbf7d0}
  .warn{background:rgba(245,158,11,.12); border:1px solid rgba(245,158,11,.35); color:#fde68a}
  .bad{background:rgba(239,68,68,.12); border:1px solid rgba(239,68,68,.35); color:#fecaca}
  .meta{display:flex; gap:10px; flex-wrap:wrap}
  .cols{display:grid; grid-template-columns: 1fr 1fr; gap:12px;}
  .list{margin:0; padding-left:18px}
  .list li{margin:6px 0}
  .muted{color:var(--muted)}
  .kbd{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
       font-size:12px; background:#0b1020; padding:2px 6px; border-radius:6px; border:1px solid rgba(148,163,184,.2)}
  .footer{font-size:12px; color:var(--muted); text-align:center; margin:18px 0}
  .table{width:100%; border-collapse:collapse; font-size:13px}
  .table th,.table td{padding:10px; border-bottom:1px dashed rgba(148,163,184,.2); text-align:left}
  .tag{display:inline-block; padding:4px 8px; border-radius:999px; border:1px solid rgba(148,163,184,.2);
       margin:2px; font-size:12px; color:#cbd5e1; background:#0e1729}
  .i{opacity:.8}
  .stack{display:flex; flex-direction:column; gap:8px}
  .right{display:flex; gap:8px; align-items:center}
  .sep{height:1px; background:rgba(148,163,184,.15); margin:12px 0}
  .hidden{display:none !important}
  .danger{color:#fecaca}
  .success{color:#bbf7d0}
</style>
</head>
<body>
<div class="wrap">
  <header>
    <svg width="42" height="42" viewBox="0 0 24 24" fill="none"><path d="M4 7h16M4 12h16M4 17h16" stroke="url(#g)" stroke-width="2" stroke-linecap="round"/><defs><linearGradient id="g" x1="0" y1="0" x2="24" y2="24"><stop stop-color="#38bdf8"/><stop offset="1" stop-color="#a78bfa"/></linearGradient></defs></svg>
    <div>
      <h1>AR Advisor — Smart Helper</h1>
      <div class="sub">Pick the situation or drop in hints about your attachments. I’ll suggest <b>Classification</b>, <b>AR Type</b>, <b>who to send</b>, <b>how many ARs</b>, and <b>required attachments</b>.</div>
    </div>
    <div style="margin-left:auto"><button class="btn small" id="btnClear">Reset</button></div>
  </header>

  <div class="grid">
    <!-- LEFT -->
    <div class="card">
      <div class="hd"><h3>1) Tell me about the issue</h3>
        <div class="right">
          <span class="pill ok" id="statusPill">Live inference</span>
        </div>
      </div>
      <div class="bd">
        <div class="cols">
          <div class="stack">
            <label>Issue context</label>
            <div class="radio-group" id="ctx">
              <label class="chip"><input type="radio" name="ctx" value="fabrication"> On-floor build / fit-up</label>
              <label class="chip"><input type="radio" name="ctx" value="design_mech"> Design/Drawing — Mechanical</label>
              <label class="chip"><input type="radio" name="ctx" value="design_elec"> Design/Drawing — Electrical</label>
              <label class="chip"><input type="radio" name="ctx" value="receiving"> Incoming / Receiving</label>
              <label class="chip"><input type="radio" name="ctx" value="quality"> Inspection finding (QI)</label>
              <label class="chip"><input type="radio" name="ctx" value="commissioning"> Commissioning / On site</label>
              <label class="chip"><input type="radio" name="ctx" value="supplier"> Supplier-related</label>
              <label class="chip"><input type="radio" name="ctx" value="trending"> Global / Trending</label>
              <label class="chip"><input type="radio" name="ctx" value="improvement"> Process improvement</label>
            </div>
            <div class="sep"></div>
            <label>What did you attach (or will attach)?</label>
            <div class="check-group" id="att">
              <label class="chip"><input type="checkbox" value="drawing"> Eng drawing(s)</label>
              <label class="chip"><input type="checkbox" value="mbom"> MBOM / OPMBOM</label>
              <label class="chip"><input type="checkbox" value="photos"> Photos / video</label>
              <label class="chip"><input type="checkbox" value="po"> Purchase Order (PO)</label>
              <label class="chip"><input type="checkbox" value="supplier_form"> Supplier form (PDF)</label>
              <label class="chip"><input type="checkbox" value="inspection_report"> Inspection report</label>
              <label class="chip"><input type="checkbox" value="related_ars"> List of related ARs</label>
            </div>
            <div class="sep"></div>
            <label>Quick flags</label>
            <div class="check-group" id="flags">
              <label class="chip"><input type="checkbox" value="potential"> Potential future risk (no failure yet)</label>
              <label class="chip"><input type="checkbox" value="deviation"> Request temporary deviation from design</label>
            </div>
          </div>
          <div class="stack">
            <label>Short description (optional, improves suggestions)</label>
            <textarea id="desc" placeholder="Ex: Shaft OD oversize; hole mismatch vs drawing; received scratched parts; on-site jam; want nickel plating due to lead time, etc."></textarea>
            <div class="cols">
              <div>
                <label>Project #</label>
                <input id="project" type="text" placeholder="e.g., 3391">
              </div>
              <div>
                <label>Machine serial #</label>
                <input id="serial" type="text" placeholder="e.g., 3391-005">
              </div>
            </div>
            <div class="cols">
              <div>
                <label>Choose AR Type (optional)</label>
                <select id="arType">
                  <option value="">Let the tool decide</option>
                  <option>Non-Conformance (existing issue)</option>
                  <option>Preventive Action (potential issue)</option>
                  <option>Improvement</option>
                  <option>Acceptance Authorization</option>
                  <option>Trending issue</option>
                </select>
              </div>
              <div>
                <label>Priority</label>
                <select id="prio">
                  <option>Medium (6–10 days)</option>
                  <option>Low (11–20 days)</option>
                  <option>High (2–5 days)</option>
                  <option>Urgent (0–2 days)</option>
                </select>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- RIGHT -->
    <div class="card">
      <div class="hd"><h3>2) Recommendation</h3>
        <div class="right">
          <button class="btn small" id="copyBtn">Copy summary</button>
        </div>
      </div>
      <div class="bd">
        <div class="row meta">
          <span class="pill" id="recClass" title="Classification"></span>
          <span class="pill" id="recType" title="AR Type"></span>
          <span class="pill" id="recCount" title="How many ARs"></span>
        </div>
        <div class="sep"></div>
        <div class="cols">
          <div>
            <h4 style="margin:0 0 6px">Who to send</h4>
            <div id="recipients" class="muted"></div>
          </div>
          <div>
            <h4 style="margin:0 0 6px">Required attachments</h4>
            <ul id="reqList" class="list muted"></ul>
          </div>
        </div>
        <div class="sep"></div>
        <div>
          <h4 style="margin:0 0 6px">Notes & rationale</h4>
          <div id="rationale" class="muted"></div>
        </div>
        <div class="sep"></div>
        <div>
          <div class="row">
            <h4 style="margin:0">Priority guide</h4>
            <span class="hint">Escalation hints appear automatically.</span>
          </div>
          <div id="prioNote" class="muted"></div>
        </div>
      </div>
    </div>
  </div>

  <div class="card" style="margin-top:18px">
    <div class="hd">
      <h3>3) Your team directory (edit & it will be saved)</h3>
      <button id="restoreDefault" class="btn small ghost">Restore defaults</button>
    </div>
    <div class="bd">
      <table class="table" id="dirTable"></table>
      <div class="hint">Tip: put names, teams, or emails (e.g., “Chas / Eng Mgr & Gerard / PM”). Saved locally.</div>
    </div>
  </div>

  <div class="footer">
    Built for quick AR decisions. Guidance derived from your AR procedure (attachments & routing hints, supplier rules, and priority timelines). — <span class="i">v1.0</span>
  </div>
</div>

<script>
(function(){
  const el = id => document.getElementById(id);
  const $ = (sel, root=document)=> Array.from(root.querySelectorAll(sel));

  // ---- directory (editable)
  const defaultDirectory = {
    "Mechanical Design": "Engineering Manager; Mechanical Design Lead",
    "Electrical Design": "Engineering Manager; Electrical Design Lead",
    "Fabrication": "Project Manager; Manufacturing Lead; Mechanical Design Lead",
    "Supplier": "Purchasing; Supplier Quality; Mechanical/Elec Design Lead",
    "Receiving": "Receiving Supervisor; Purchasing; Mechanical Design Lead",
    "Quality Inspector": "Quality Manager; Mechanical Design Lead",
    "Commissioning": "Commissioning Lead; Project Manager; Design Lead",
    "Trending issue": "Engineering Manager; All Project Managers",
    "Preventive Action": "Engineering Manager; Project Manager",
    "Improvement": "Process/Production Engineering Manager; Quality Manager",
    "Acceptance Authorization": "Engineering Manager; Project Manager (fast approval)"
  };

  function loadDirectory(){
    const saved = JSON.parse(localStorage.getItem('ar_dir') || 'null');
    return saved || defaultDirectory;
  }
  function saveDirectory(d){
    localStorage.setItem('ar_dir', JSON.stringify(d));
  }

  function renderDirectory(){
    const d = loadDirectory();
    const rows = Object.entries(d).map(([k,v])=>{
      return `<tr>
        <th style="width:220px">${k}</th>
        <td contenteditable="true" data-key="${k}">${v}</td>
      </tr>`
    }).join("");
    el('dirTable').innerHTML = `<tr><th>Area / Type</th><th>Default recipients</th></tr>` + rows;
    $('#dirTable [contenteditable]').forEach(cell=>{
      cell.addEventListener('input', ()=>{
        const d = loadDirectory();
        d[cell.dataset.key] = cell.textContent.trim();
        saveDirectory(d);
        infer();
      });
    });
  }

  // ---- inputs
  const inputs = ['desc','project','serial','arType','prio'];
  inputs.forEach(i=> el(i).addEventListener('input', infer));
  $('#ctx input[type=radio]').forEach(x=> x.addEventListener('change', infer));
  $('#att input[type=checkbox]').forEach(x=> x.addEventListener('change', infer));
  $('#flags input[type=checkbox]').forEach(x=> x.addEventListener('change', infer));

  el('btnClear').addEventListener('click', ()=>{
    $('input[type=radio]').forEach(x=> x.checked=false);
    $('input[type=checkbox]').forEach(x=> x.checked=false);
    inputs.forEach(i=> el(i).value = i==='prio' ? 'Medium (6–10 days)' : '');
    infer();
  });

  el('restoreDefault').addEventListener('click', ()=>{
    saveDirectory(defaultDirectory);
    renderDirectory();
    infer();
  });

  el('copyBtn').addEventListener('click', ()=>{
    navigator.clipboard.writeText(buildSummary()).then(()=>{
      el('statusPill').textContent = 'Summary copied ✓';
      setTimeout(()=> el('statusPill').textContent = 'Live inference', 1500);
    });
  });

  // ---- logic
  function hasAtt(tag){ return !!$('#att input[type=checkbox][value="'+tag+'"]')[0]?.checked; }
  function hasFlag(tag){ return !!$('#flags input[type=checkbox][value="'+tag+'"]')[0]?.checked; }
  function ctxVal(){ const c = $('#ctx input:checked')[0]; return c? c.value : ""; }

  function inferClassification(){
    const c = ctxVal();
    if(c==='design_mech') return 'Mechanical Design';
    if(c==='design_elec') return 'Electrical Design';
    if(c==='fabrication') return 'Fabrication';
    if(c==='receiving') return 'Receiving';
    if(c==='quality') return 'Quality Inspector';
    if(c==='commissioning') return 'Commissioning';
    if(c==='supplier') return 'Supplier';
    if(c==='trending') return 'Mechanical Design'; // default; user can route widely
    if(c==='improvement') return 'Fabrication';
    // infer from attachments if no context selected
    if(hasAtt('inspection_report')) return 'Quality Inspector';
    if(hasAtt('supplier_form') && hasAtt('po')) return 'Supplier';
    if(hasAtt('po')) return 'Receiving';
    if(hasAtt('drawing') || hasAtt('mbom')) return 'Fabrication';
    return 'Mechanical Design';
  }

  function inferType(){
    const chosen = el('arType').value;
    if(chosen) return chosen;
    if(ctxVal()==='trending' || hasAtt('related_ars')) return 'Trending issue';
    if(hasFlag('deviation')) return 'Acceptance Authorization';
    if(hasFlag('potential')) return 'Preventive Action (potential issue)';
    if(ctxVal()==='improvement') return 'Improvement';
    return 'Non-Conformance (existing issue)';
  }

  function howManyARs(classif, type){
    if(type==='Trending issue') return '1 global trending AR (reference related ARs)';
    if(type.startsWith('Preventive')) return '1 per project number';
    if(type==='Improvement') return '1 per project (or per process scope)';
    if(type==='Acceptance Authorization') return '1 per affected machine serial';
    if(classif==='Supplier') return '1 per Purchase Order';
    if(['Fabrication','Receiving','Quality Inspector','Commissioning'].includes(classif)) return '1 per machine serial';
    if(['Mechanical Design','Electrical Design'].includes(classif)) return '1 per project number';
    return '1 per project';
  }

  function requiredAttachments(classif, type){
    const baseDesign = [
      'Compare design vs current issue',
      'Attach drawings of all parts mentioned',
      'Attach any referenced document/note',
      'Provide possible solution with expected date'
    ];
    const baseFab = [
      'Compare design vs current issue',
      'Clearly identify mismatch to released design',
      'Attach drawings of all parts mentioned',
      'Attach any referenced document/note',
      'Specify requested completion date'
    ];
    const req = {
      'Mechanical Design': baseDesign,
      'Electrical Design': baseDesign,
      'Fabrication': baseFab,
      'Receiving': ['Use when parts received are damaged or do not match PO/Eng MBOM', 'Photos of condition', 'PO copy'],
      'Quality Inspector': ['Attach inspection report', 'Include inspection number in description', 'Include assembly number in description'],
      'Commissioning': ['On-site issue within original project scope', 'Photos/video of the issue', 'Any design refs (drawings/notes)'],
      'Supplier': [
        'Supplier form (PDF)',
        'Purchase Order attachment',
        'Timeline / action requirements',
        'Drawings & any referenced docs'
      ]
    };
    // Type-specific extras
    if(type==='Trending issue') req[classif] = (req[classif]||[]).concat(['Include related AR numbers in description']);
    if(type==='Acceptance Authorization') req[classif] = (req[classif]||[]).concat(['State temporary deviation clearly']);
    return req[classif] || ['Describe the issue and attach supporting evidence'];
  }

  function recipientsFor(classif, type){
    const dir = loadDirectory();
    const lookA = dir[classif] || '';
    const lookB = dir[type] || '';
    return [lookA, lookB].filter(Boolean).join(' + ');
  }

  function buildRationale(classif, type){
    const bits = [];
    if(classif==='Supplier') bits.push('Supplier ARs are limited to one per PO and must include the supplier form and the PO.');
    if(classif==='Receiving') bits.push('Receiving ARs are used when parts arrive damaged or do not match the PO or Engineering MBOM.');
    if(classif==='Quality Inspector') bits.push('QI AR requires the inspection report and both the inspection number and assembly number in the description.');
    if(type==='Trending issue') bits.push('Trending issue is intended for recurring problems across projects; list related ARs.');
    if(type.startsWith('Preventive')) bits.push('Preventive Action is for a potential issue that has not occurred yet.');
    if(type==='Acceptance Authorization') bits.push('Acceptance Authorization is a panic/temporary deviation from released design.');
    if(['Mechanical Design','Electrical Design','Fabrication'].includes(classif)) bits.push('For design/fabrication, attach drawings and any referenced notes, and compare design vs issue; add a completion/expected date.');
    return bits.join(' ');
  }

  function priorityNote(p){
    if(p.startsWith('Urgent')){
      return '<span class="danger">Urgent (0–2 days):</span> ping Engineering Manager for Design or Project Manager for any Fabrication-type in addition to normal routing.';
    }
    if(p.startsWith('High')){
      return '<span class="">High (2–5 days):</span> must be closed within a business week.';
    }
    if(p.startsWith('Medium')){
      return 'Medium (6–10 days): target resolution within two business weeks.';
    }
    return 'Low (11–20 days): close within three–four business weeks.';
  }

  function infer(){
    const classif = inferClassification();
    const type = inferType();
    const count = howManyARs(classif, type);
    const req = requiredAttachments(classif, type);

    el('recClass').textContent = 'Classification: ' + classif;
    el('recType').textContent = 'AR Type: ' + type;
    el('recCount').textContent = 'Submit: ' + count;

    el('recipients').textContent = recipientsFor(classif, type) || 'Add recipients in the directory below.';

    el('reqList').innerHTML = req.map(x=> `<li>${x}</li>`).join('');

    const rat = buildRationale(classif, type);
    const extra = [];
    const pr = el('prio').value;
    extra.push(priorityNote(pr));
    if(classif==='Supplier') extra.push('Reminder: submit only one Supplier AR per PO.');
    el('rationale').innerHTML = [rat, extra.join(' ')].filter(Boolean).join(' ');

    el('prioNote').innerHTML = priorityNote(pr);
  }

  function buildSummary(){
    const classif = el('recClass').textContent.replace('Classification: ','').trim();
    const type = el('recType').textContent.replace('AR Type: ','').trim();
    const count = el('recCount').textContent.replace('Submit: ','').trim();
    const who = el('recipients').textContent.trim();
    const reqs = Array.from(el('reqList').querySelectorAll('li')).map(li=>'- '+li.textContent).join('\n');
    const project = el('project').value.trim();
    const serial = el('serial').value.trim();
    const prio = el('prio').value.trim();
    const desc = el('desc').value.trim();
    return `AR Summary
Context: ${ctxVal() || 'n/a'}
Classification: ${classif}
AR Type: ${type}
Project #: ${project || '—'}   Serial #: ${serial || '—'}
Priority: ${prio}
Who to send: ${who || '—'}
How many to submit: ${count}

Required attachments:
${reqs}

Description:
${desc || '—'}`;
  }

  // initial
  renderDirectory();
  infer();
})();  
</script>
</body>
</html>
"""

# Write the file
path = "/mnt/data/ar_advisor.html"
with open(path, "w", encoding="utf-8") as f:
    f.write(html)

path
